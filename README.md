# LogScope Frontend

     _                ____                       
    | |    ___   __ _/ ___|  ___ ___  _ __   ___ 
    | |   / _ \ / _` \___ \ / __/ _ \| '_ \ / _ \
    | |__| (_) | (_| |___) | (_| (_) | |_) |  __/
    |_____\___/ \__, |____/ \___\___/| .__/ \___|
                |___/                |_|         

Version 1.0.0

## Overview

LogScope supports analysis of event (telemetry) streams. The tool takes as input: 

- a formal specification of the requirements the event stream has to satisfy
- an event stream

and produces on standard output a report describing where (if at all) the event stream violates the specification.

The event stream can be submitted online, as the monitored software is executing, or it can be read from a log file. The Logscope Specification Language, named Scope, 
merges rule-based programming with state machines.

LogScope consists of two parts: a _frontend_ and a _backend_.

- The _frontend_ parses a specification written in Scope, and translates it to a C++ file (named `contract.cpp`)
- The _backend_ imports the generated C++ file `contract.cpp` and performs the actual event monitoring

This README file explains the **frontend**: how to generate `contract.cpp` from a specification written in the Scope language.

The **backend** monitoring an event sequence using the
 `contract.cpp` generated by the frontend can be found [here](https://github.jpl.nasa.gov/logscope/backend).

An example specification in the Scope language is the following, formalizing the requirement that: 

_"Every command (with a name `x`) must eventually succeed, without a failure before"_.

```
monitor CommandsMustSucceed {
  always {
    COMMAND(name : x) => RequireSuccess(x)
  }

  hot RequireSuccess(cmdName) {
    FAIL(name : cmdName) => error
    SUCCESS(name : cmdName) => ok
  }
}
```

## Manual

A manual containing the information in this README file as well an introduction to the specification language Scope can be found here: [[pdf]](https://github.jpl.nasa.gov/logscope/frontend/tree/master/manual/logscope_manual.pdf)
  
## Installing the LogScope Frontend:

The directory ``out`` contains the following files needed for installing and running the LogScope frontend:

* `logscope` : script to run the translator from the Scope specification language to C++
* `artifacts/frontend_jar/frontend.jar` : the logscope jar file used by the script above

The LogScope frontend is implemented in Scala and uses GrapViz for visualizing specifications.

1. Install the Scala programming language: [https://www.scala-lang.org/download](https://www.scala-lang.org/download).
2. Install GraphViz: [https://graphviz.org](https://graphviz.org).
2. Place the files ``logscope`` and ``frontend.jar`` mentioned above in some directory **LOGSCOPE_DIR** (standing for the total path to this directory). The name and location of the directory is not important.
3. cd to  **LOGSCOPE_DIR** and make the logscope script executable:

        chmod +x logscope
     
4. Make the logscope script reachable from anywhere, e.g. by updating the `PATH` variable in your `.bash_profile` file (or similar) to include the `LOGSCOPE_DIR` directory.

        export PATH=LOGSCOPE_DIR:$PATH
        
## Running the LogScope Frontend

The script is applied as follows to N files (for N >= 1) comtaining monitor specifications in the Scope language:

    logscope <spec1> .... <specN>

LogScope will merge the montior specifications in the different files into one specification and process it. It does not matter in which other file files are provided, or how monitors are distributed over the files.

## Results from the LogScope Frontend

**Parsing and type checking** 

The specification is parsed, type checked, and finally translated to C++ if parsing and type checking succeeds.

In case of parsing or type checking errors, information about these will be printed on standard out.

**Generated files**

LogScope will generate: 

* logscope-generated : directory containing
  - contract.cpp : file containing generated C++ code
  - monitors-visualized : directory containing visualizations of monitors in .png format
 
## Developer

* [Klaus Havelund](http://www.havelund.com), Jet Propulsion Laboratory, USA

## Github Repositories

- [LogScope organization](https://github.jpl.nasa.gov/logscope) : containing all repositories
- [Front end](https://github.jpl.nasa.gov/logscope/frontend) : parser and translator from DSL to C++, written in Scala.
- [Back end](https://github.jpl.nasa.gov/logscope/backend) : monitoring engine written in C++.
- [Website](https://github.jpl.nasa.gov/logscope/logscope.github.io) : website.

## Copyright statement

Copyright 2021, by the California Institute of Technology. ALL RIGHTS RESERVED.
United States Government Sponsorship acknowledged. Any commercial use must be negotiated
with the Office of Technology Transfer at the California Institute of Technology.
This software may be subject to U.S. export control laws. By accepting this software,
the user agrees to comply with all applicable U.S. export laws and regulations. User has
the responsibility to obtain export licenses, or other export authority as may be required before exporting such information to foreign countries or providing access to foreign persons.    
